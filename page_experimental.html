<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script>
      
      async function getToken(code) {
        await fetch(`https://teste-next-js-weld.vercel.app/api/get_auth_token`, {
          method: "POST",
          body: JSON.stringify({
            'code_id' : code
          })
        }) .then(response => response)
        .then(data => {
          return data;
        })
      }
      
      const queryString = window.location.search;
      const urlParams   = new URLSearchParams(queryString);
      if (queryString.includes('?code=')) {
        var x = getToken(urlParams.get('code'));
        document.write(x);
      } else {
        // check login
      }
    </script>
  </head>
  <body>
    <header></header>
    <main></main>
    <footer></footer>
  </body>
</html>
